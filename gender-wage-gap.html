<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">

  <link rel="canonical" href="/gender-wage-gap" />


  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="I want to understand the wage gap more fully. Join me in an exploration of the data!Here are some questions I still want to ask:">

  <meta property="og:site_name" content="My digital garden">

  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">

  <link rel="stylesheet" href="/thoughts/styles.css">

  
  <meta property="og:description" content="I want to understand the wage gap more fully. Join me in an exploration of the data!Here are some questions I still want to ask:"/>
  

  
  <meta property="og:title" content="Gender wage gap">
  <meta property="og:type" content="article">
  

  
  <meta property="article:published_time" content="2021-12-04T00:57:46-06:00">
  <meta property="article:author" content="/">
  

  <meta property="og:url" content="/gender-wage-gap" />

  

  <title>
    
      Gender wage gap &mdash; My digital garden
    
  </title>
</head>

  <body>
    <nav><div>
    <a class="internal-link" href="/thoughts/"><b>My digital garden</b></a>
</div>
</nav>
    <div class="wrapper">
      <main><article>
	<div>
		<h1>Gender wage gap</h1>
		<time datetime="2021-12-03T01:42:03-06:00"
			> Last updated on December 3, 2021 
		</time>
		
		<p>
			This article will take 2 minutes to read.
		</p>
	</div>

	<div id="notes-entry-container">
		<content> <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p>I want to understand the wage gap more fully. Join me in an exploration of the data!</p>
<h2 id="here-are-some-questions-i-still-want-to-ask">Here are some questions I still want to ask:</h2>

<ul>
  <li>
    <p>Where? Are there different wage gaps per country? Which is the least different country?</p>
  </li>
  <li>
    <p>What are the real distributions? Are there places where women earn more on average?</p>
  </li>
  <li>
    <p>What’s the breakdown by industry?</p>
  </li>
  <li>
    <p>Does age play a role?</p>
  </li>
  <li>
    <p>Are there mitigating factors?</p>
  </li>
  <li>
    <p>What are the sources?</p>
  </li>
  <li>
    <p>Does it exist? Is the 70c figure accurate? In what way?</p>
  </li>
</ul>

<h2 id="thoughts">Thoughts</h2>

<p>According to the <a href="https://www.aauw.org/app/uploads/2020/02/AAUW-2018-SimpleTruth-nsa.pdf" target="blank">aaw</a> the gap is more accurately around 80c or 20%</p>

<p>In almost All jobs, women earn significatly less than mean on average.</p>

<p><a href="https://public.tableau.com/shared/RRBQ2YSTR?:display_count=y&amp;:origin=viz_share_link&amp;:embed=y" target="blank">PLEASE look at this graph, it’s crazy</a></p>

<h2 id="quote">Quote:</h2>
<blockquote>
  <p>women spent an average of 6.3 hours more per week doing household chores than men (15.5 versus 9.2 hours) and 2.4 hours more per week providing care to household members (4.4 versus 2.0 hours). Women also, on average, spent more time both purchasing goods and services and traveling related to unpaid household work per week than their male counterparts. Data from the Organisation for Economic Cooperation and Development (OECD) indicates that American men spend 141 minutes per day on unpaid household labor, while women spend 245 minutes.</p>
</blockquote>

<p>https://www.ncsl.org/research/labor-and-employment/the-gender-pay-gap.aspx</p>

<h2 id="the-wage-gap-paradox">The wage gap paradox</h2>

<p>If I were to ask you in which you would expect the highest percentage of engineers to be female, what would you answer? Take a moment to think about it before you answer.</p>

<p>Let me give you the statistics:</p>

<p>Some Highest percentage of female engineers countries:</p>

<ul>
  <li>Algeria</li>
  <li>Tunisia</li>
  <li>Turkey</li>
  <li>UAE</li>
  <li>Saudi Arabia</li>
</ul>

<p>Some of the Lowest percentage countries:</p>

<ul>
  <li>Chile</li>
  <li>Belgium</li>
  <li>Norway</li>
  <li>Netherlands</li>
</ul>

<p>You get the picture. Well actually, here’s an actual picture:</p>

<p><img src="https://i.imgur.com/QsD5cX6.png" alt="Gender wage gap"></p>

<p>Here’s another:</p>

<p><img src="https://i.imgur.com/waxh8Yv.png" alt="Gender wage gap"></p>

<p>A simple though probably flawed conclusion to draw from this is simple: When women are freer to choose, they are less likely to choose high-paying engineering majors.</p>

<p><a href="https://journals.sagepub.com/doi/10.1177/0956797617741719" target="blank">Here’s an article talking about the paradox</a></p>

<p>This topic is more complex than most people realize. So I only ask that you don’t take what everyone tells you for granted, the data is super interesting.</p>

<p>I recommend you try this interactive data analysis tool from the U.S. Department of Labor:</p>

<p>https://www.dol.gov/agencies/wb/data/occupations</p>
</body></html>
 </content>

		<side style="font-size: 0.9em">
			<h3 style="margin-bottom: 1em">Notes mentioning this note</h3>
			

			<div style="font-size: 0.9em">
				<p>There are no notes linking to this note.</p>
			</div>
			
		</side>
	</div>
</article>

<hr />

<p>
	Here are all the notes in this garden, along with their links, visualized as a
	graph.
</p>

<link rel="stylesheet" href="/thoughts/styles.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"
  integrity="sha512-FHsFVKQ/T1KWJDGSbrUhTJyS1ph3eRrxI228ND0EGaEp6v4a/vGwPWd3Dtd/+9cI7ccofZvl/wulICEurHN1pg=="
  crossorigin="anonymous"></script>

<div id="graph-wrapper">
  <script>
    const MINIMAL_NODE_SIZE = 8;
    const MAX_NODE_SIZE = 12;
    const ACTIVE_RADIUS_FACTOR = 1.5;
    const STROKE = 1;
    const FONT_SIZE = 16;
    const TICKS = 200;
    const FONT_BASELINE = 40;
    const MAX_LABEL_LENGTH = 50;

    const graphData = {"edges":[{"source":"5188","target":"2999201619697069501634358623"},{"source":"322234889594959904287976177977333310","target":"2999201619697069501634358623"},{"source":"2999201619697069501634358623","target":"139364562788709894460"},{"source":"48798472605868","target":"139364562788709894460"},{"source":"30580185173690978251209839330823784984790960504123992","target":"30580185173690978251209839330823784984790960504123992"},{"source":"112249223031179760904","target":"30580185173690978251209839330823784984790960504123992"},{"source":"31321329","target":"180753616121083182516892576052374"},{"source":"30580185173690978251209839330823784984790960504123992","target":"112249223031179760904"},{"source":"180753616121083182516892576052374","target":"112249223031179760904"},{"source":"1763762412024906028","target":"112249223031179760904"},{"source":"28588532718914019","target":"851959675378839870668214146935173903921656770713504310"},{"source":"851959675378839870668214146935173903921656770713504310","target":"138734357957655644665841381049197"},{"source":"156849270984","target":"14164651000280702137235454773983180365518714"},{"source":"30580185173690978251209839330823784984790960504123992","target":"14164651000280702137235454773983180365518714"},{"source":"28588532718914019","target":"14164651000280702137235454773983180365518714"},{"source":"28588532718914019","target":"29219254455833079817448874380493139516041658354"},{"source":"28588532718914019","target":"8321929263829500520001590617580"},{"source":"28588532718914019","target":"9568481444242231265272899075988"},{"source":"156849270984","target":"28588532718914019"},{"source":"851959675378839870668214146935173903921656770713504310","target":"28588532718914019"},{"source":"61377431968146851350","target":"28588532718914019"},{"source":"14164651000280702137235454773983180365518714","target":"28588532718914019"},{"source":"29219254455833079817448874380493139516041658354","target":"28588532718914019"},{"source":"8321929263829500520001590617580","target":"28588532718914019"},{"source":"9568481444242231265272899075988","target":"28588532718914019"},{"source":"139470821993759286144044303812","target":"32244691158976995"},{"source":"3113163156336982","target":"32244691158976995"},{"source":"32244691158976995","target":"139470821993759286144044303812"},{"source":"2821131889669671427968544","target":"48922530849632797250"},{"source":"1763762412024906028","target":"824534291158"},{"source":"4709867162609643192266254","target":"824534291158"},{"source":"5184178749366653159163169043486126","target":"5184178749366653159163169043486126"},{"source":"1017130","target":"5184178749366653159163169043486126"},{"source":"19933540676606105509146638724513455248814","target":"5184178749366653159163169043486126"},{"source":"4846159064514930645808","target":"144746523937507619282891570418938"},{"source":"156849270984","target":"69390740316523005805421"},{"source":"60687409686190","target":"710990157"},{"source":"1078371630875","target":"1248930636599398"},{"source":"156849270954","target":"369112424640144724099524049259611606349212"},{"source":"994473405622","target":"369112424640144724099524049259611606349212"},{"source":"1763762412024906028","target":"369112424640144724099524049259611606349212"},{"source":"180753616121083182516892576052374","target":"994473405622"},{"source":"5184178749366653159163169043486126","target":"994473405622"},{"source":"1763762412024906028","target":"994473405622"},{"source":"4846159064514930645808","target":"994473405622"},{"source":"661971381217685597538799694926473497603","target":"994473405622"},{"source":"180753616121083182516892576052374","target":"27625501053"},{"source":"3113163156336982","target":"27625501053"},{"source":"80377193658620","target":"2821131889669671427968544"},{"source":"5188","target":"1763762412024906028"},{"source":"156849270948","target":"1763762412024906028"},{"source":"112249223031179760904","target":"1763762412024906028"},{"source":"5184178749366653159163169043486126","target":"1763762412024906028"},{"source":"69390740316523005805421","target":"1763762412024906028"},{"source":"925133130","target":"1763762412024906028"},{"source":"4709867162609643192266254","target":"1763762412024906028"},{"source":"1017130","target":"1763762412024906028"},{"source":"19933540676606105509146638724513455248814","target":"1763762412024906028"},{"source":"7280361401045307096321516310","target":"1763762412024906028"},{"source":"1656585590","target":"1763762412024906028"},{"source":"4846159064514930645808","target":"1763762412024906028"},{"source":"139364562788709894460","target":"83018600558489467664308"},{"source":"156849270954","target":"1146488277592"},{"source":"1229376203065","target":"69472166824454116025"},{"source":"5184178749366653159163169043486126","target":"1936017189498044194"},{"source":"7280361401045307096321516310","target":"1936017189498044194"},{"source":"31321329","target":"938643886093627773357497261469886763561987674851287"},{"source":"322234889594959904287976177977333310","target":"41956963483055"},{"source":"80377193658620","target":"41956963483055"},{"source":"1078371630875","target":"724154"},{"source":"2999201619697069501634358623","target":"48798472605868"},{"source":"2831430989473755432","target":"38508221255"},{"source":"60687409686190","target":"38508221255"},{"source":"994473405622","target":"6670398760433916529920290938924"},{"source":"1763762412024906028","target":"6670398760433916529920290938924"},{"source":"824534291158","target":"31321329"},{"source":"2831430989473755432","target":"947070"},{"source":"60687409686190","target":"2831430989473755432"},{"source":"156849270948","target":"60687409686190"},{"source":"156849272286","target":"60687409686190"},{"source":"27625501053","target":"60687409686190"},{"source":"38508221255","target":"60687409686190"},{"source":"3113163156336982","target":"60687409686190"},{"source":"4846159064514930645808","target":"1017130"},{"source":"3234502938714701091668906","target":"2264355281396153"},{"source":"994473405622","target":"882917400369905601542465306151800315627585836"},{"source":"1763762412024906028","target":"882917400369905601542465306151800315627585836"},{"source":"369112424640144724099524049259611606349212","target":"241487729522082782712181165059"},{"source":"112249223031179760904","target":"19933540676606105509146638724513455248814"},{"source":"5184178749366653159163169043486126","target":"19933540676606105509146638724513455248814"},{"source":"156849270948","target":"7280361401045307096321516310"},{"source":"2999201619697069501634358623","target":"7280361401045307096321516310"},{"source":"180753616121083182516892576052374","target":"7280361401045307096321516310"},{"source":"1248930636599398","target":"7280361401045307096321516310"},{"source":"7911115959333522059653054041106570281","target":"7280361401045307096321516310"},{"source":"1078371630875","target":"7280361401045307096321516310"},{"source":"938643886093627773357497261469886763561987674851287","target":"7280361401045307096321516310"},{"source":"48798472605868","target":"7280361401045307096321516310"},{"source":"322234889594959904287976177977333310","target":"7280361401045307096321516310"},{"source":"69564937057126","target":"7280361401045307096321516310"},{"source":"1656585590","target":"7280361401045307096321516310"},{"source":"661971381217685597538799694926473497603","target":"7280361401045307096321516310"},{"source":"3880675842258417385","target":"7280361401045307096321516310"},{"source":"48798472605868","target":"5715803688430697516337046"},{"source":"31321329","target":"5715803688430697516337046"},{"source":"5188","target":"1656585590"},{"source":"139364562788709894460","target":"2225540912812"},{"source":"180753616121083182516892576052374","target":"2225540912812"},{"source":"48922530849632797250","target":"2225540912812"},{"source":"1248930636599398","target":"2225540912812"},{"source":"83018600558489467664308","target":"2225540912812"},{"source":"1936017189498044194","target":"2225540912812"},{"source":"938643886093627773357497261469886763561987674851287","target":"2225540912812"},{"source":"48798472605868","target":"2225540912812"},{"source":"38508221255","target":"2225540912812"},{"source":"2264355281396153","target":"2225540912812"},{"source":"600985992508277337610241939720248266","target":"2225540912812"},{"source":"994473405622","target":"4846159064514930645808"},{"source":"1763762412024906028","target":"4846159064514930645808"},{"source":"1017130","target":"4846159064514930645808"},{"source":"2821131889669671427968544","target":"80377193658620"},{"source":"48798472605868","target":"80377193658620"},{"source":"4709867162609643192266254","target":"80377193658620"},{"source":"2831430989473755432","target":"2915050175911258"},{"source":"994473405622","target":"65732866111916601640207183698355406623923430483262320"},{"source":"1763762412024906028","target":"65732866111916601640207183698355406623923430483262320"},{"source":"322234889594959904287976177977333310","target":"137647653643972833609772"},{"source":"180753616121083182516892576052374","target":"661971381217685597538799694926473497603"},{"source":"994473405622","target":"661971381217685597538799694926473497603"},{"source":"31321329","target":"661971381217685597538799694926473497603"},{"source":"7911115959333522059653054041106570281","target":"3880675842258417385"},{"source":"1146488277592","target":"3880675842258417385"},{"source":"2999201619697069501634358623","target":"1384620"},{"source":"139364562788709894460","target":"1384620"},{"source":"851959675378839870668214146935173903921656770713504310","target":"1384620"},{"source":"824534291158","target":"1384620"},{"source":"7911115959333522059653054041106570281","target":"1384620"},{"source":"369112424640144724099524049259611606349212","target":"1384620"},{"source":"83018600558489467664308","target":"1384620"},{"source":"7280361401045307096321516310","target":"1384620"},{"source":"851959675378839870668214146935173903921656770713504310","target":"3113163156336982"},{"source":"61377431968146851350","target":"3113163156336982"},{"source":"14164651000280702137235454773983180365518714","target":"3113163156336982"},{"source":"29219254455833079817448874380493139516041658354","target":"3113163156336982"},{"source":"8321929263829500520001590617580","target":"3113163156336982"},{"source":"9568481444242231265272899075988","target":"3113163156336982"},{"source":"32244691158976995","target":"3113163156336982"},{"source":"139470821993759286144044303812","target":"3113163156336982"},{"source":"2831430989473755432","target":"3113163156336982"},{"source":"60687409686190","target":"3113163156336982"}],"nodes":[{"id":"5188","path":"/thoughts/404","label":"404"},{"id":"156849270948","path":"/thoughts/2020-08-10","label":"2020 08 10"},{"id":"156849270954","path":"/thoughts/2020-08-16","label":"2020 08 16"},{"id":"156849270984","path":"/thoughts/2020-08-20","label":"2020 08 20"},{"id":"156849272284","path":"/thoughts/2020-09-24","label":"2020 09 24"},{"id":"156849272286","path":"/thoughts/2020-09-26","label":"2020 09 26"},{"id":"1229376203065","path":"/thoughts/formula-1","label":"Formula 1"},{"id":"77742258872156127745","path":"/thoughts/gender-wage-gap","label":"Gender wage gap"},{"id":"2999201619697069501634358623","path":"/thoughts/a-guide-to-being-human","label":"A Guide To Being Human"},{"id":"139364562788709894460","path":"/thoughts/tetrafarmakos","label":"Tetrafarmakos"},{"id":"3234502938714701091668906","path":"/thoughts/employee-pipeline","label":"Employee pipeline"},{"id":"30580185173690978251209839330823784984790960504123992","path":"/thoughts/designing-data-intensive-applications","label":"Designing Data Intensive Applications"},{"id":"180753616121083182516892576052374","path":"/thoughts/discourse-on-inequality","label":"Discourse On Inequality"},{"id":"112249223031179760904","path":"/thoughts/notes-on-papers","label":"Notes On Papers"},{"id":"851959675378839870668214146935173903921656770713504310","path":"/thoughts/administraci%C3%B3n-de-proyectos-de-ingenier%C3%ADa","label":"Administración De Proyectos De Ingeniería"},{"id":"138734357957655644665841381049197","path":"/thoughts/administration-project","label":"Administration Project"},{"id":"61377431968146851350","path":"/thoughts/cyber-security","label":"Cyber Security"},{"id":"14164651000280702137235454773983180365518714","path":"/thoughts/dise%C3%B1o-y-arquitectura-de-software","label":"Diseño Y Arquitectura De Software"},{"id":"29219254455833079817448874380493139516041658354","path":"/thoughts/literatura-mundial-contemporanea","label":"Literatura Mundial Contemporanea"},{"id":"8321929263829500520001590617580","path":"/thoughts/metodos-cuantitativos","label":"Metodos Cuantitativos"},{"id":"9568481444242231265272899075988","path":"/thoughts/programming-languages","label":"Programming Languages"},{"id":"28588532718914019","path":"/thoughts/7th-semester","label":"7th Semester"},{"id":"32244691158976995","path":"/thoughts/8th-semester","label":"8th Semester"},{"id":"139470821993759286144044303812","path":"/thoughts/dise%C3%B1o-de-compiladores","label":"Diseño De Compiladores"},{"id":"1799374978","path":"/thoughts/trauma","label":"Trauma"},{"id":"48922530849632797250","path":"/thoughts/about-this-site","label":"About This Site"},{"id":"824534291158","path":"/thoughts/ai-safety","label":"Ai Safety"},{"id":"5184178749366653159163169043486126","path":"/thoughts/artificial-intelligence","label":"Artificial Intelligence"},{"id":"144746523937507619282891570418938","path":"/thoughts/attention-architecture","label":"Attention Architecture"},{"id":"69390740316523005805421","path":"/thoughts/baseball-project","label":"Baseball Project"},{"id":"710990157","path":"/thoughts/brazil","label":"Brazil"},{"id":"1248930636599398","path":"/thoughts/capitalism","label":"Capitalism"},{"id":"7911115959333522059653054041106570281","path":"/thoughts/condensed-notes-on-free-will","label":"Condensed Notes On Free Will"},{"id":"369112424640144724099524049259611606349212","path":"/thoughts/convolutional-neural-networks","label":"Convolutional Neural Networks"},{"id":"994473405622","path":"/thoughts/coursera","label":"Coursera"},{"id":"27625501053","path":"/thoughts/covid-19","label":"Covid 19"},{"id":"2821131889669671427968544","path":"/thoughts/creating-elements","label":"Creating Elements"},{"id":"1763762412024906028","path":"/thoughts/deep-learning","label":"Deep Learning"},{"id":"83018600558489467664308","path":"/thoughts/diogenes-la%C3%ABrtius","label":"Diogenes Laërtius"},{"id":"1078371630875","path":"/thoughts/dream-job","label":"Dream Job"},{"id":"1146488277592","path":"/thoughts/emotions","label":"Emotions"},{"id":"69472166824454116025","path":"/thoughts/entertainment","label":"Entertainment"},{"id":"1936017189498044194","path":"/thoughts/epistemology","label":"Epistemology"},{"id":"938643886093627773357497261469886763561987674851287","path":"/thoughts/ethical-imperative-for-ethical-action","label":"Ethical Imperative For Ethical Action"},{"id":"41956963483055","path":"/thoughts/evergreen","label":"Evergreen"},{"id":"925133130","path":"/thoughts/fastai","label":"Fastai"},{"id":"724154","path":"/thoughts/fire","label":"F.I.R.E"},{"id":"1228348228096","path":"/thoughts/foam-tips","label":"Foam Tips"},{"id":"48798472605868","path":"/thoughts/happiness","label":"Happiness"},{"id":"38508221255","path":"/thoughts/houston","label":"Houston"},{"id":"6670398760433916529920290938924","path":"/thoughts/hyperparameter-tuning","label":"Hyperparameter Tuning"},{"id":"31321329","path":"/thoughts/inbox","label":"Inbox"},{"id":"114599682438088626488116","path":"/thoughts/intent-and-values","label":"Intent. And Values"},{"id":"947070","path":"/thoughts/kari","label":"Kari"},{"id":"4709867162609643192266254","path":"/thoughts/laymans-ai-summary","label":"Laymans Ai Summary"},{"id":"2831430989473755432","path":"/thoughts/life-in-mexico","label":"Life In Mexico"},{"id":"60687409686190","path":"/thoughts/life-story","label":"Life Story"},{"id":"322234889594959904287976177977333310","path":"/thoughts/illusion-of-climate-change","label":"Illusion Of Climate Change"},{"id":"1017130","path":"/thoughts/lstm","label":"Lstm"},{"id":"2264355281396153","path":"/thoughts/management","label":"Management"},{"id":"1355333928","path":"/thoughts/mexico","label":"Mexico"},{"id":"882917400369905601542465306151800315627585836","path":"/thoughts/neural-networks-and-deep-learning","label":"Neural Networks And Deep Learning"},{"id":"241487729522082782712181165059","path":"/thoughts/neural-style-transfer","label":"Neural Style Transfer"},{"id":"69564937057126","path":"/thoughts/on-poverty","label":"On Poverty"},{"id":"19933540676606105509146638724513455248814","path":"/thoughts/on-the-measure-of-intelligence","label":"On The Measure Of Intelligence"},{"id":"7280361401045307096321516310","path":"/thoughts/personal-philosophy","label":"Personal Philosophy"},{"id":"5715803688430697516337046","path":"/thoughts/purpose-of-society","label":"Purpose Of Society"},{"id":"1656585590","path":"/thoughts/readme","label":"Readme"},{"id":"2225540912812","path":"/thoughts/seedling","label":"Seedling"},{"id":"4846159064514930645808","path":"/thoughts/sequence-models","label":"Sequence Models"},{"id":"80377193658620","path":"/thoughts/short-trek","label":"Short Trek"},{"id":"2915050175911258","path":"/thoughts/sparkademy","label":"Sparkademy"},{"id":"65732866111916601640207183698355406623923430483262320","path":"/thoughts/structuring-machine-learning-projects","label":"Structuring Machine Learning Projects"},{"id":"137647653643972833609772","path":"/thoughts/mexican-politics","label":"Mexican Politics"},{"id":"661971381217685597538799694926473497603","path":"/thoughts/the-modern-and-the-postmodern","label":"The Modern And The Postmodern"},{"id":"3880675842258417385","path":"/thoughts/theory-of-mind","label":"Theory Of Mind"},{"id":"1384620","path":"/thoughts/todo","label":"Todo"},{"id":"3113163156336982","path":"/thoughts/university","label":"University"},{"id":"600985992508277337610241939720248266","path":"/thoughts/you-re-a-hypocrite-but-so-am-i","label":"You're a hypocrite, but so am I"}]}
    let nodesData = graphData.nodes;
    let linksData = graphData.edges;

    const nodeSize = {};

    const updateNodeSize = () => {
      nodesData.forEach((el) => {
        let weight =
          3 *
          Math.sqrt(
            linksData.filter((l) => l.source === el.id || l.target === el.id)
              .length + 1
          );
        if (weight < MINIMAL_NODE_SIZE) {
          weight = MINIMAL_NODE_SIZE;
        } else if (weight > MAX_NODE_SIZE) {
          weight = MAX_NODE_SIZE;
        }
        nodeSize[el.id] = weight;
      });
    };

    const onClick = (d) => {
      window.location = d.path
    };

    const onMouseover = function (d) {
      const relatedNodesSet = new Set();
      linksData
        .filter((n) => n.target.id == d.id || n.source.id == d.id)
        .forEach((n) => {
          relatedNodesSet.add(n.target.id);
          relatedNodesSet.add(n.source.id);
        });

      node.attr("class", (node_d) => {
        if (node_d.id !== d.id && !relatedNodesSet.has(node_d.id)) {
          return "inactive";
        }
        return "";
      });

      link.attr("class", (link_d) => {
        if (link_d.source.id !== d.id && link_d.target.id !== d.id) {
          return "inactive";
        }
        return "";
      });

      link.attr("stroke-width", (link_d) => {
        if (link_d.source.id === d.id || link_d.target.id === d.id) {
          return STROKE * 4;
        }
        return STROKE;
      });
      text.attr("class", (text_d) => {
        if (text_d.id !== d.id && !relatedNodesSet.has(text_d.id)) {
          return "inactive";
        }
        return "";
      });
    };

    const onMouseout = function (d) {
      node.attr("class", "");
      link.attr("class", "");
      text.attr("class", "");
      link.attr("stroke-width", STROKE);
    };

    const sameNodes = (previous, next) => {
      if (next.length !== previous.length) {
        return false;
      }

      const map = new Map();
      for (const node of previous) {
        map.set(node.id, node.label);
      }

      for (const node of next) {
        const found = map.get(node.id);
        if (!found || found !== node.title) {
          return false;
        }
      }

      return true;
    };

    const sameEdges = (previous, next) => {
      if (next.length !== previous.length) {
        return false;
      }

      const set = new Set();
      for (const edge of previous) {
        set.add(`${edge.source.id}-${edge.target.id}`);
      }

      for (const edge of next) {
        if (!set.has(`${edge.source}-${edge.target}`)) {
          return false;
        }
      }

      return true;
    };

    const graphWrapper = document.getElementById('graph-wrapper')
    const element = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    element.setAttribute("width", graphWrapper.getBoundingClientRect().width);
    element.setAttribute("height", window.innerHeight * 0.8);
    graphWrapper.appendChild(element);

    const reportWindowSize = () => {
      element.setAttribute("width", window.innerWidth);
      element.setAttribute("height", window.innerHeight);
    };

    window.onresize = reportWindowSize;

    const svg = d3.select("svg");
    const width = Number(svg.attr("width"));
    const height = Number(svg.attr("height"));
    let zoomLevel = 1;

    const simulation = d3
      .forceSimulation(nodesData)
      .force("forceX", d3.forceX().x(width / 2))
      .force("forceY", d3.forceY().y(height / 2))
      .force("charge", d3.forceManyBody())
      .force(
        "link",
        d3
          .forceLink(linksData)
          .id((d) => d.id)
          .distance(70)
      )
      .force("center", d3.forceCenter(width / 2, height / 2))
      .force("collision", d3.forceCollide().radius(80))
      .stop();

    const g = svg.append("g");
    let link = g.append("g").attr("class", "links").selectAll(".link");
    let node = g.append("g").attr("class", "nodes").selectAll(".node");
    let text = g.append("g").attr("class", "text").selectAll(".text");

    const resize = () => {
      if (d3.event) {
        const scale = d3.event.transform;
        zoomLevel = scale.k;
        g.attr("transform", scale);
      }

      const zoomOrKeep = (value) => (zoomLevel >= 1 ? value / zoomLevel : value);

      const font = Math.max(Math.round(zoomOrKeep(FONT_SIZE)), 1);

      text.attr("font-size", (d) => font);
      text.attr("y", (d) => d.y - zoomOrKeep(FONT_BASELINE) + 8);
      link.attr("stroke-width", zoomOrKeep(STROKE));
      node.attr("r", (d) => {
        return zoomOrKeep(nodeSize[d.id]);
      });
      svg
        .selectAll("circle")
        .filter((_d, i, nodes) => d3.select(nodes[i]).attr("active"))
        .attr("r", (d) => zoomOrKeep(ACTIVE_RADIUS_FACTOR * nodeSize[d.id]));
    };

    const ticked = () => {
      node.attr("cx", (d) => d.x).attr("cy", (d) => d.y);
      text
        .attr("x", (d) => d.x)
        .attr("y", (d) => d.y - (FONT_BASELINE - nodeSize[d.id]) / zoomLevel);
      link
        .attr("x1", (d) => d.source.x)
        .attr("y1", (d) => d.source.y)
        .attr("x2", (d) => d.target.x)
        .attr("y2", (d) => d.target.y);
    };

    const restart = () => {
      updateNodeSize();
      node = node.data(nodesData, (d) => d.id);
      node.exit().remove();
      node = node
        .enter()
        .append("circle")
        .attr("r", (d) => {
          return nodeSize[d.id];
        })
        .on("click", onClick)
        .on("mouseover", onMouseover)
        .on("mouseout", onMouseout)
        .merge(node);

      link = link.data(linksData, (d) => `${d.source.id}-${d.target.id}`);
      link.exit().remove();
      link = link.enter().append("line").attr("stroke-width", STROKE).merge(link);

      text = text.data(nodesData, (d) => d.label);
      text.exit().remove();
      text = text
        .enter()
        .append("text")
        .text((d) => shorten(d.label.replace(/_*/g, ""), MAX_LABEL_LENGTH))
        .attr("font-size", `${FONT_SIZE}px`)
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .on("click", onClick)
        .on("mouseover", onMouseover)
        .on("mouseout", onMouseout)
        .merge(text);

      node.attr("active", (d) => isCurrentPath(d.path) ? true : null);
      text.attr("active", (d) => isCurrentPath(d.path) ? true : null);

      simulation.nodes(nodesData);
      simulation.force("link").links(linksData);
      simulation.alpha(1).restart();
      simulation.stop();

      for (let i = 0; i < TICKS; i++) {
        simulation.tick();
      }

      ticked();
    };

    const zoomHandler = d3.zoom().scaleExtent([0.2, 3]).on("zoom", resize);

    zoomHandler(svg);
    restart();

    function isCurrentPath(notePath) {
      return window.location.pathname.includes(notePath)
    }

    function shorten(str, maxLen, separator = ' ') {
      if (str.length <= maxLen) return str;
      return str.substr(0, str.lastIndexOf(separator, maxLen)) + '...';
    }
  </script>
</div>

</main>
      <footer>Made with love by Alan Macedo Esparza, C. 2021</footer>
    </div>

    <!-- That file is not particularly elegant. This will need a refactor at some point. -->


<div style="opacity: 0; display: none;" id='tooltip-wrapper'>
  <div id='tooltip-content'>
  </div>
</div>

<iframe style="display: none; height: 0; width: 0;" id='link-preview-iframe' src="">
</iframe>

<script>
  var opacityTimeout;
  var contentTimeout;
  var transitionDurationMs = 100;

  var iframe = document.getElementById('link-preview-iframe')
  var tooltipWrapper = document.getElementById('tooltip-wrapper')
  var tooltipContent = document.getElementById('tooltip-content')

  function hideTooltip() {
    opacityTimeout = setTimeout(function() {
      tooltipWrapper.style.opacity = 0;
      contentTimeout = setTimeout(function() {
        tooltipContent.innerHTML = '';
        tooltipWrapper.style.display = 'none';
      }, transitionDurationMs + 1);
    }, transitionDurationMs)
  }

  function showTooltip(event) {
    var elem = event.target;
    var elem_props = elem.getClientRects()[elem.getClientRects().length - 1];
    var top = window.pageYOffset || document.documentElement.scrollTop

    if (event.target.host === window.location.host) {
      iframe.src = event.target.href
      iframe.onload = function() {
        tooltipContentHtml = ''
        tooltipContentHtml += '<div style="font-weight: bold;">' + iframe.contentWindow.document.querySelector('h1').innerHTML + '</div>'
        tooltipContentHtml += iframe.contentWindow.document.querySelector('content').innerHTML

        tooltipContent.innerHTML = tooltipContentHtml

        tooltipWrapper.style.display = 'block';
        setTimeout(function() {
          tooltipWrapper.style.opacity = 1;
        }, 1)
      }

      tooltipWrapper.style.left = elem_props.left - (tooltipWrapper.offsetWidth / 2) + (elem_props.width / 2) + "px";
      if ((window.innerHeight - elem_props.top) < (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top - tooltipWrapper.offsetHeight - 10 + "px";
      } else if ((window.innerHeight - elem_props.top) > (tooltipWrapper.offsetHeight)) {
          tooltipWrapper.style.top = elem_props.top + top + 35 + "px";
      }

      if ((elem_props.left + (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = "10px";
      } else if ((document.body.clientWidth - elem_props.left - (elem_props.width / 2)) < (tooltipWrapper.offsetWidth / 2)) {
          tooltipWrapper.style.left = document.body.clientWidth - tooltipWrapper.offsetWidth - 20 + "px";
      }
    }
  }

  function setupListeners(linkElement) {
    linkElement.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('mouseleave', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    tooltipWrapper.addEventListener('touchend', function(_event) {
      hideTooltip();
    });

    linkElement.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
      showTooltip(event);
    });

    tooltipWrapper.addEventListener('mouseenter', function(event) {
      clearTimeout(opacityTimeout);
      clearTimeout(contentTimeout);
    });
  }

  document.querySelectorAll('content a').forEach(setupListeners);
</script>

  </body>
</html>
